<div class="content" role="main">
    <section class="hero">
        <div class="container">
            <div class="row align-items-center justify-content-center text-center">
                <div class="col-sm-12 col-md-4 mb30">
                  <div class="row">
                      <div class="col-sm-6 col-md-12">
                          <label class="mb0" style="color: #1AD9C6;">Total Deployed on Market</label>
                          <div class="supply-balance color-danger">${{localeString(totalCashDeployed, 0)}}</div>
                      </div>
                      <div class="col-sm-6 col-md-12" style="margin-top: 0.7em;">
                          <label class="mb0" style="color: #1AD9C6;">My Deployed Balance</label>
                          <div class="supply-balance color-danger">${{toDecimal(totalSupplyBalance, 7)}}</div>
                      </div>
                  </div>
                </div>
                <div class="col-sm-4 col-7 mb30">
                    <div class="progress-circle--container">
                        <div class="progress progress-circle" data-percentage="100">
                            <span class="progress-left">
                                <span class="progress-bar"></span>
                            </span>
                            <span class="progress-right">
                                <span class="progress-bar"></span>
                            </span>
                            <div class="progress-value">
                                <div>
                                    <span>Net APY</span>
                                    {{toDecimal(apyData.netApy, 2)}}%
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-4 mb30">
                    <div class="row">
                        <div class="col-sm-6 col-md-12">
                            <label class="mb0" style="color: #1AD9C6;">Total Collateral on Market</label>
                            <div class="borrow-balance color-danger">${{localeString(totalAssetTokenSupply, 0)}}</div>
                        </div>
                        <div class="col-sm-6 col-md-12" style="margin-top: 0.7em;">
                            <label class="mb0" style="color: #1AD9C6;">Total Loans on Market</label>
                            <div class="borrow-balance color-danger">${{localeString(totalCashLoans, 0)}}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section>
        <div class="container-lg">
            <div class="row">
                <div class="col-md-10 offset-md-1">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="portlet portlet--height-full">
                                <div class="portlet__head">
                                    <div class="portlet__head-caption">
                                        <div class="portlet__head-title">
                                            <h3 class="portlet__head-text">Deploy</h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="portlet__body py0 px0">
                                    <div class="asset-list">
                                        <div class="labels row">
                                            <div class="col-sm-4 col-4">
                                                <label>Asset</label>
                                            </div>
                                            <div class="col-sm-3 col-3 text-left d-none d-sm-block">
                                                <label>APY</label>
                                            </div>
                                            <div class="col-sm-3 col-3 text-left">
                                                <label>Non Deployed</label>
                                            </div>
                                            <div class="col-sm-2 col-3 text-left">
                                                <label>Deployed</label>
                                            </div>
                                        </div>
                                        <div class="assets">
                                            <a class="asset" *ngFor="let token of cashTokenData; let i = index"
                                                (click)="openSupplyModal(token.id)">
                                                <div class="col-4 col-sm-4">
                                                    <div class="balance">
                                                        <img src="assets/img/{{ token.symbol }}_logo.png" alt="{{ token.symbol }} logo" class="token-logos" />
                                                        <div style="display: inline-block;">{{token.symbol}}</div>
                                                        <span class="subtitle d-block d-sm-none">{{token.supplyApy}}%</span>
                                                    </div>
                                                </div>
                                                <div class="col-sm-3 col-3 text-left d-none d-sm-block">
                                                    <div class="balance">
                                                        <div>{{token.supplyApy}}%</div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-3 col-3 text-left">
                                                    <div class="balance">
                                                        <div>{{ toDecimal(token.tokenBalance, 2) }} <!-- {{ token.symbol }} --></div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-3 col-3 text-left">
                                                  <div class="balance">
                                                      <div>${{ toDecimal(token.cTokenSupplyBalanceUSD, 2) }} <!-- {{ token.symbol }} --></div>
                                                  </div>
                                                  <div class="balance">
                                                    <div>{{ toDecimal(token.cTokenSupplyBalance, 2) }} {{ token.symbol }}</div>
                                                  </div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="portlet portlet--height-full">
                                <div class="portlet__head">
                                    <div class="portlet__head-caption">
                                        <div class="portlet__head-title">
                                            <h3 class="portlet__head-text">Asset Explorer</h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="portlet__body py0 px0">
                                    <div class="asset-list">
                                        <div class="labels row">
                                            <div class="col-sm-2 col-3">
                                                <label>Asset</label>
                                            </div>
                                            <div class="col-sm-4 col-4 text-left">
                                                <label>Type</label>
                                            </div>
                                            <div class="col-sm-4 col-3 text-left">
                                                <label>Collateral Value</label>
                                            </div>
                                            <div class="col-sm-2 col-2 text-left">
                                                <label>Tokens</label>
                                            </div>
                                        </div>
                                        <div class="assets">
                                            <div class="asset" style="cursor: default;" *ngFor="let token of assetTokenData; let i = index">
                                                <div class="col-sm-2 col-3">
                                                    <div class="balance">
                                                        <img src="assets/img/ether_logo.png" style="max-height: 30px;" alt="Ether logo" />
                                                        <div style="display: inline-block;">{{token.symbol}}</div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-4 col-4 text-left">
                                                    <div class="balance">
                                                        <div>
                                                          <a href="https://www.konkrete.io/queen-street" target="_blank">Mortgage, Real Estate</a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-4 col-3 text-left">
                                                    <div class="balance">
                                                        <div>{{localeString(token.erc20TotalSupply, 0)}}</div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-2 col-2 text-left">
                                                    <!-- <div><a href="{{ token.erc20Link }}" target="_blank">Link</a></div> -->
                                                    <div><a href="https://etherscan.io/address/0xcd90e3093be92ebdb48510349a1cf5f63c3977d5#readContract"
                                                      target="_blank">Link</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="hero">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="section-title text-center wow zoomIn">
                        <h1>Frequently Asked Questions</h1>
                        <br>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                        What is the OTL?
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                <div class="panel-body">
                                    <p>OTL stands for Open Token Lending. Right now we are in the alpha version of a proposed uniswap style fully decentralized and censorship resistant token lending protocol in which any token can be lent against any other token as collateral. </p>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingTwo">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                        How do I interact with the OTL?
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                                <div class="panel-body">
                                    <p>You can connect via metamask or wallet connect to the OTL and supply DAI, USDC and USDT to the platform and start earning interest immediately. You may withdraw your deployed tokens at any time, including accrued interest (provided there is liquidity, which we are working towards improving).</p>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingThree">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                        What can I lend with?
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                                <div class="panel-body">
                                    <p>While eventually it should be possible to lend any token against any token, right now we allow DAI, USDC and USDT. More currency pegged tokens will be added in the coming days on the lending side.</p>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingFour">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                        Who can borrow from the platform? What is being used as collateral?
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseFour" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFour">
                                <div class="panel-body">
                                    <p>Eventually anyone with tokenised assets can borrow from the platform by using the asset as collateral. Right now we have tokenized a commercial property loan in Victoria, Australia and are using that as collateral. You can check details of the property and the loan from the Asset Explorer. To ensure a good amount of over collateralization for lenders we have picked a loan which is only lending to 60% of the property’s value. On top of that, we have a collateral factor of 80% of the value of the loan on the system. </p>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingFive">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                                        What is the Asset Explorer?
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseFive" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFive">
                                <div class="panel-body">
                                    <p>The asset explorer is where you can view the tokenized assets being used as collateral on the system. It includes the token name, the type of asset, it’s collateral value on the system, and the link to the token contract itself. By clicking the link under asset Type, you will be directed to an information page with more details on the asset including any relevant loan agreements. </p>
                                    <br>
                                    <img src="assets/img/faqs/asset_explorer.png" class="mx-auto d-block img-fluid" style="max-width: 600px; margin: auto" />
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingSix">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
                                        How often is interest calculated? Can I take my deployed funds out any time?
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseSix" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingSix">
                                <div class="panel-body">
                                    <p>Interest is calculated per each ethererum block which is roughly every 15 seconds. You can take out your funds, including interest, anytime - provided there is enough liquidity in the pool. Liquidity of a particular asset is shown when you click the asset. In the example below, it shows that 10 USDT can be withdrawn from the pool. </p>
                                    <br>
                                    <img src="assets/img/faqs/sample_modal.png" class="mx-auto d-block img-fluid" style="max-width: 600px; margin: auto;" />
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingSeven">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseEight" aria-expanded="false" aria-controls="collapseEight">
                                        I just deployed, and the interest rate went down. Why?
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseEight" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingSeven">
                                <div class="panel-body">
                                    <p>The interest rate from the pool is dynamically adjusted. As more lenders deploy, the interest will reduce until the additional amount in the pool is borrowed. This is similar to utilisation rate on other protocols. When more borrowers borrow from the pool interest rates will come back up. </p>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingEight">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">
                                        Clicking Enable, Deploy or Withdraw doesn’t seem to do anything
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseSeven" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingEight">
                                <div class="panel-body">
                                    <p>Firstly, ensure you’re connected to the OTL with either Metamask or Wallet Connect. Clicking any of the above buttons will require your wallet to confirm the transaction, which is a prompt you’ll have to confirm. Once you have confirmed the transaction the OTL will refresh to reflect your changes.</p>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingNine">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseNine" aria-expanded="false" aria-controls="collapseEight">
                                        Are there governance tokens?
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseNine" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingNine">
                                <div class="panel-body">
                                    <p>Once the alpha is complete, platform governance tokens will be distributed to investors, core team and to the community. Stay tuned for updates.</p>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingTen">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseEleven" aria-expanded="false" aria-controls="collapseEleven">
                                        What are kTokens?
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseEleven" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTen">
                                <div class="panel-body">
                                    <p>kTokens are similar to cTokens, or aTokens and iTokens etc from other money market platforms out there. They represent your claim to the money you have deployed on the platform and its interest. <br><br> Once you deploy DAI, USDC, USDT to the platform you will receive an ERC20 kDAI, kUSDC, kUSDT respectively. These are interest bearing tokens and steadily rise in value. <br><br> While on the platform interface they are not visible, you may check them in your metamask by adding those custom tokens. </p> <br> The addresses are <br><br>
                                    <table class="table table-bordered col-md-10 offset-md-1 col-sm-12 text-justify">
                                        <tbody>
                                          <tr>
                                            <td>kDAI</td>
                                            <td>0xE5C6c14F466A4F3A73eCEc7F3aAaA15c5EcBc769</td>
                                          </tr>
                                          <tr>
                                            <td>kUSDC</td>
                                            <td>0x882Ec5A4a22b110BE602762E85758A02943de187</td>
                                          </tr>
                                          <tr>
                                            <td>kUSDT</td>
                                            <td>0x5eddA8366d9221fc8aF079248f03c82763f0C193</td>
                                          </tr>
                                        </tbody>
                                    </table>
                                    <br>
                                    Eventually these kTokens should be freely tradeable themselves and can serve as a medium of exchange.
                                </div>
                            </div>
                        </div>
                    </div>
                </div><!--- END COL -->
            </div><!--- END ROW -->
        </div>
    </section>
</div>

<div *ngIf="loadComplete" class="modal fade" id="supplyModal" tabindex="-1" role="dialog" aria-labelledby="supplyModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content" style="background-color: #E6EDF6;">
            <div class="modal-body py0 px0">
                <div class="row my0 mx0">
                    <div class="col-lg-6 py0 px0" style="background-color: #fff;">
                        <div class="py15 px15 d-block d-lg-none">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="my20 mx15" id="supplyGroup" style="position: relative;">
                            <select id="supply" name="supply" class="select2-main" style="width: 100%;"></select>
                        </div>
                        <div class="d-none d-lg-block">
                        </div>
                        <div class="px15">
                            <div class="calculation">
                                <span class="description">Deployed APY</span>
                                <span class="color-success">{{tokenData[selectedTokenIndex].supplyApy}}%</span>
                            </div>
                            <div class="calculation">
                                <span class="description">Price</span>
                                <span>$ {{tokenData[selectedTokenIndex].priceUsd}}</span>
                            </div>
                            <!-- <div class="calculation">
                                <span class="description">Collateral Factor</span>
                                <span>{{tokenData[selectedTokenIndex].collateralFactor}}%</span>
                            </div> -->
                            <div class="calculation">
                                <span class="description">Non Deployed</span>
                                <span>{{toDecimal(tokenData[selectedTokenIndex].tokenBalance, 2)}}
                                    {{ tokenData[selectedTokenIndex].symbol }}</span>
                            </div>
                            <div class="calculation">
                              <span class="description">Liquidity</span>
                              <span>{{toDecimal(tokenData[selectedTokenIndex].availableBorrow, 2)}}
                                  {{ tokenData[selectedTokenIndex].symbol }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 py0 px0">
                        <div class="py15 px15">
                            <button type="button" class="close d-none d-lg-block" data-dismiss="modal"
                                aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <div class="form" *ngIf="tokenData[selectedTokenIndex].approved">
                                <div class="row">
                                    <div class="col-6">
                                        <button [ngClass]="{'active': typeViewSupply == 'withdraw'}"
                                            class="btn btn-lg btn-full btn-secondary"
                                            (click)="viewWithdrawForm()">Withdraw</button>
                                    </div>
                                    <div class="col-6">
                                        <button [ngClass]="{'active': typeViewSupply == 'supply'}"
                                            class="btn btn-lg btn-full btn-secondary"
                                            (click)="viewSupplyForm()">Deploy</button>
                                    </div>
                                </div>
                                <div class="my30">
                                    <form>
                                        <div class="row align-items-center">
                                            <div class="col-12">
                                                <input type="text" class="form-control form-control-lg text-center"
                                                    placeholder="0" [(ngModel)]="amountInput" name="amountInput">
                                            </div>
                                        </div>
                                    </form>
                                    <div class="mt30">
                                        <div class="calculation">
                                            <span class="description">Deployed Balance</span>
                                            <span>
                                                ${{toDecimal(tokenData[selectedTokenIndex].cTokenSupplyBalanceUSD, 3)}}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <button class="btn btn-lg btn-full btn-secondary" (click)="withdrawUnderlying()"
                                        *ngIf="typeViewSupply == 'withdraw'">Withdraw</button>
                                    <button class="btn btn-lg btn-full btn-secondary" (click)="mint()"
                                        *ngIf="typeViewSupply == 'supply'">Deploy</button>
                                </div>
                            </div>
                            <div class="form" *ngIf="!tokenData[selectedTokenIndex].approved">
                                <div class="text-center">
                                  <img src="assets/img/{{tokenData[selectedTokenIndex].symbol}}_logo.png" style="max-height: 130px;" alt="{{tokenData[selectedTokenIndex].symbol}} logo" />
                                </div>
                                <div class="mt20 mb30" style="font-weight: 500;">
                                    To interact with the OTL protocol using {{tokenData[selectedTokenIndex].symbol}}, you need to enable it first.
                                </div>
                                <button class="btn btn-lg btn-full btn-secondary"
                                    (click)="enableSupplyCollateral()">Enable</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
